## => Final Query
with t1 (ARTID, ANAME, ARTEPOCH, ARTYEAR) as (select B.ARTID, A.ANAME, \
  B.ARTEPOCH, B.ARTYEAR from ARTIST2016 A INNER JOIN ARTOBJ2016 B ON \
  A.A_ID=B.A_ID) \
  select t1.ARTID, t1.ANAME as ARTIST, t1.ARTEPOCH, C.ARTSTATE, MAX(ARTCOST) \
  as PRICE, C.ARTDATE from t1 INNER JOIN Permanent2016 C ON t1.ARTID=C.ARTID \
  GROUP BY t1.ANAME, t1.ARTID, C.ARTDATE, t1.ARTEPOCH, C.ARTSTATE ORDER BY PRICE desc fetch first 1 rows only
