with t1 (ARTID, ANAME) as (select B.ARTID, A.ANAME from ARTIST2016 A \ 
INNER JOIN ARTOBJ2016 B ON A.A_ID=B.A_ID), \
t2 (EXIBNAME, ARTID, STARTDATE, ENDDATE, EXIBSTART, EXIBEND) \
as (select C.EXIBNAME, D.ARTID, D.STARTDATE, \
D.ENDDATE, C.EXIBSTART, C.EXIBEND from exibition2016 C \ 
INNER JOIN EXPOSED2016 D ON C.E_ID=D.E_ID) \
select EXIBNAME, t1.ARTID, STARTDATE, ENDDATE, EXIBSTART, EXIBEND, t1.ANAME as ARTIST from t1, t2 where t1.ARTID=t2.ARTID


# => JOIN ARTIST2016 with ARTOBJ2016 on A_ID to get the artist names
select B.ARTID, A.ANAME from ARTIST2016 A \
INNER JOIN ARTOBJ2016 B ON A.A_ID=B.A_ID

with t1 (ARTID, ANAME) as (select B.ARTID, A.ANAME from ARTIST2016 A \
INNER JOIN ARTOBJ2016 B ON A.A_ID=B.A_ID)
###
# => Tables, Permanent2016 (ARTCOST, ARTSATE, ARTDATE)
select t1.ARTID, ANAME as ARTIST, AEPOCH as ARTEPOCH, MAX(ARTCOST) as PRICE, ARTDATE from t1 A INNER JOIN Permanent2016 B ON A.ARTID=B.ARTID GROUP BY t1.ARTID


## => Final Query
with t1 (ARTID, ANAME, ARTEPOCH, ARTYEAR) as (select B.ARTID, A.ANAME, \
  B.ARTEPOCH, B.ARTYEAR from ARTIST2016 A INNER JOIN ARTOBJ2016 B ON \
  A.A_ID=B.A_ID) \
  select t1.ARTID, t1.ANAME as ARTIST, t1.ARTEPOCH, C.ARTSTATE, MAX(ARTCOST) \
  as PRICE, C.ARTDATE from t1 INNER JOIN Permanent2016 C ON t1.ARTID=C.ARTID \
  GROUP BY t1.ANAME, t1.ARTID, C.ARTDATE, t1.ARTEPOCH, C.ARTSTATE ORDER BY PRICE desc fetch first 1 rows only
